<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Kişisel veri tabanı." />
    <meta name="author" content="pondesivon" />
    <title>Aktif Hücrenin Rengini Değiştir - Microsoft Excel</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../css/prism.css" rel="stylesheet" />
</head>
<body>
    <!-- Responsive navbar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="../../index.html">Pondesivon</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" aria-current="page" href="../../index.html">Ana Sayfa</a></li>
                    <li class="nav-item"><a class="nav-link" href="../../hakkinda.html">Hakkında</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page content-->
    <div class="container">
       <br>
       <div class="row">
        <div class="col">
           <h1>Aktif Hücrenin Rengini Değiştir - Microsoft Excel</h1>
           <hr /><p class="lead">Seçili hücrenin rengini değiştiriyor. Seçim ortadan kalktığı zaman da hücrenin varsayılan renk biçimine getiriyor. Böylelikle seçili hücre renklenmiş oluyor.
</p><hr /><div class="alert alert-info"><strong>Kod</strong></div>
<pre><code class="language-vb">
Option Explicit

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Static EskiHucre As Range

    On Error Resume Next
    
    If Target.Interior.ColorIndex = -4142 Then
        Target.Interior.ColorIndex = 27
        EskiHucre.Interior.ColorIndex = xlColorIndexNone
        Set EskiHucre = Target
    Else
        EskiHucre.Interior.ColorIndex = xlColorIndexNone
    End If
End Sub
</code></pre>

<div class="alert alert-info"><strong>Kod (Açıklamalı)</strong></div>
<pre><code class="language-vb">
Option Explicit

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    
    '--------------------------------------------------
    'Bir sonraki seçimi yaptığımız anda eski hücrenin
    'varsayılan haline gelmesini istiyoruz. Bunun için de
    'hangi hücreyi seçtiğimizi bilmemiz gerekiyor. Static
    'bir değişkenle eski hücre bilgisini tutuyoruz.
    '
    'Static değişken özetle şu işe yarıyor. Normalde Sub
    'yordam her çalıştığında istisna durumlar dışında
    'değişkenlere de bir nevi sıfırdan atama yapılıyor.
    'Static değişken bu noktada işimize yarıyor.
    'Değişkene atanan değeri kaybetmiyoruz ve böylelikle
    'metod yeniden çalıştığında değişkene son atanan
    'değerden devam edebiliyoruz.
    '--------------------------------------------------
    Static EskiHucre As Range
    
    '--------------------------------------------------
    'Eğer bir hata olursa bir sonraki satırdan devam et.
    '--------------------------------------------------
    On Error Resume Next
    
    '--------------------------------------------------
    'Eğer renk indeksinin değeri -4142 ise (bu değer
    'xlColorIndexNone sayı karşılığı) işlem yap.
    '--------------------------------------------------
    If Target.Interior.ColorIndex = -4142 Then
        
        '--------------------------------------------------
        'Seçili hücrenin rengi sarı olsun.
        '--------------------------------------------------
        Target.Interior.ColorIndex = 27
        
        '--------------------------------------------------
        'Bir önceki seçilen hücreyi varsayılan
        'renk biçimine döndür.
        '--------------------------------------------------
        EskiHucre.Interior.ColorIndex = xlColorIndexNone
        
        '--------------------------------------------------
        'Seçilen hücreyi EskiHucre değişkenine
        'aktar. Böylelikle yeni bir seçim olduğunda
        'bu hücre otomatik olarak eski seçilen
        'hücre olacak ve bu hücre için işlem
        'yapabileceğiz.
        '--------------------------------------------------
        Set EskiHucre = Target
        
    Else
    
        '--------------------------------------------------
        'Eğer seçilen hücrenin renk indeksi
        'xlColorIndexNone değilse en son
        'seçilen hücre için renk değişimi
        'yapılmıyor ama eski hücrede böyle
        'bir durum varsa renk indeksini
        'varsayılan biçimine getiriyoruz.
        '--------------------------------------------------
        EskiHucre.Interior.ColorIndex = xlColorIndexNone
    End If
End Sub
</code></pre>

<div class="alert alert-info"><strong>Yararlanılan Kaynaklar</strong></div>
<div class="list-group">
    <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.xlcolorindex" rel="nofollow noopener" target="_blank" class="list-group-item bg-light text-secondary">https://docs.microsoft.com/en-us/office/vba/api/excel.xlcolorindex</a>
</div>
			<hr><a href="../../index.html" class="btn btn-success">Ana Sayfaya Git</a><hr>
  </div>
</div>
</div>

<!-- JS-->
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/prism.js"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5887594848036043"
     crossorigin="anonymous"></script>
</body>
</html>
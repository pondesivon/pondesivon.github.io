<!DOCTYPE html>
<html lang="tr">
<head>
    <!-- Meta Bolumu Baslangic -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Kişisel veri tabanı." />
    <meta name="author" content="pondesivon" />
    <!-- Meta Bolumu Bitis -->
    
    <!-- Title Alani Baslangic -->
	<title>Alt Toplam Al - Microsoft Excel</title>
	<!-- Title Alani Bitis -->

    <!-- Favicon Baslangic -->
    <link rel="icon" type="image/x-icon" href="../yonetim/favicon.ico" />
    <!-- Favicon Bitis -->

    <!-- CSS Alani Baslangic -->
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../css/prism.css" rel="stylesheet" />
    <link href="../css/style.css" rel="stylesheet" />
    <!-- CSS Alani Bitis -->
</head>
<body>
    <!-- Responsive NavBar Baslangic -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand btn btn-secondary" href="../index.html">Pondesivon</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" aria-current="page" href="../index.html">Ana Sayfa</a></li>
                    <li class="nav-item"><a class="nav-link" href="../arsiv.html">Arşiv</a></li>
                    <li class="nav-item"><a class="nav-link" href="../sayfalar.html">Sayfalar</a></li>
                    <li class="nav-item">
                        <span class="btn btn-secondary mr-2" onclick="sayfaninBasinaGit();">▲</span>
                        <span class="btn btn-secondary mr-2" onclick="sayfaninSonunaGit();">▼</span>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Responsive NavBar Bitis -->

    <!-- Kapsayici Icerik Alani Baslangic -->
    <div class="container min-vh-100 mb-2">

        <!-- Icerik Ana Satir Baslangic -->
        <div class="row">

            <!-- Icerik Ana Sutun Baslangic -->
            <div class="col">

<!-- ################################################## -->
<!-- Icerik Metin Baslangic -->
<h1 class="mt-3">Alt Toplam Al - Microsoft Excel</h1><hr class="mt-1 mb-1"><p class="lead">Makro aracılığıyla alt toplam alma işlemi ile ilgili bir örnektir.</p>
<!-- bol -->
<div class="alert alert-info"><strong>Veri</strong></div>
<p>VBA kodunu malzeme sayıları veri setine göre çalıştıracağız. Veri setine aşağıdaki bağlantıdan ulaşabilirsiniz.</p>
<p><a class="btn btn-outline-primary btn-sm" href="yukleme/veri-seti-malzeme-sayilari.html" target="_blank" rel="noopener">malzeme sayıları veri seti</a></p>

<div class="alert alert-info"><strong>Kod</strong></div>
<p><pre><code class="language-vb">
Option Explicit

Sub AltToplamAl()
    Range("A1:B13").Subtotal _
                    GroupBy:=1, _
                    Function:=xlSum, _
                    TotalList:=Array(2), _
                    Replace:=True, _
                    PageBreaks:=False, _
                    SummaryBelowData:=True
End Sub

Sub AltToplamTemizle()
    Dim i As Integer
    
    Selection.ClearOutline
    
    For i = [A1048576].End(xlUp).Row To 1 Step -1
        If Cells(i, 1).Font.Bold = True Then
            Range(i & ":" & i).Delete Shift:=xlUp
        End If
    Next
End Sub
</code></pre></p>

<div class="alert alert-info"><strong>Kod (Açıklamalı)</strong></div>
<p><pre><code class="language-vb">
Option Explicit

Sub AltToplamAl()
    Range("A1:B13").Subtotal _
                    GroupBy:=1, _
                    Function:=xlSum, _
                    TotalList:=Array(2), _
                    Replace:=True, _
                    PageBreaks:=False, _
                    SummaryBelowData:=True
End Sub

Sub AltToplamTemizle()
    Dim i As Integer
    
    '--------------------------------------------------
    'Alt toplam alındığında sol kısımda oluşan
    'alt toplam çizgilerini temizliyor.
    '--------------------------------------------------
    Selection.ClearOutline
    
    '--------------------------------------------------
    'Çalışma mantığı şu:
    '
    'Bizim verilerimizin hiçbirinin yazı biçimi kalın
    'yani bold değil. Alt toplam verileri de hep bold
    'olarak biçimlendiriliyor. Eğer ben bu bold yazıları
    'tespit edersem ve bu satırı silersem alt toplam
    'verilerini de silmiş olurum.
    '
    'Döngüyü ters çalıştırmamızın sebebi de şu:
    'Satır silindiği zaman diğer satırların yerleri
    'değiştiği için doğal olarak satır sayıları da
    'değişiyor. Bu da karışıklığa sebep oluyor.
    'Tersten başlattığımızda satır silsek bile
    'üstte kalan satırlar bundan etkilenmediği
    'için sıkıntı olmuyor.
    '--------------------------------------------------
    For i = [A1048576].End(xlUp).Row To 1 Step -1
    
        '--------------------------------------------------
        'Eğer ilgili hücrenin yazı biçimi Bold ise işlem yap.
        '--------------------------------------------------
        If Cells(i, 1).Font.Bold = True Then
            
            '--------------------------------------------------
            'Satırı aşağıdaki satırlar yukarı
            'sürüklenecek şekilde sil.
            '--------------------------------------------------
            Range(i & ":" & i).Delete Shift:=xlUp
        End If
    Next
End Sub
</code></pre></p>
<!-- Icerik Metin Bitis -->
<!-- ################################################## -->

            </div>
            <!-- Icerik Ana Sutun Bitis -->

        </div>
        <!-- Icerik Ana Satir Bitis -->

    </div>
    <!-- Kapsayici Icerik Alani Bitis -->

    <!-- Responsive NavBar Baslangic -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand btn btn-secondary" href="../index.html">Pondesivon</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" aria-current="page" href="../index.html">Ana Sayfa</a></li>
                    <li class="nav-item"><a class="nav-link" href="../arsiv.html">Arşiv</a></li>
                    <li class="nav-item"><a class="nav-link" href="../sayfalar.html">Sayfalar</a></li>
                    <li class="nav-item">
                        <span class="btn btn-secondary mr-2" onclick="sayfaninBasinaGit();">▲</span>
                        <span class="btn btn-secondary mr-2" onclick="sayfaninSonunaGit();">▼</span>
                    </li>                
                </ul>
            </div>
        </div>
    </nav>
    <!-- Responsive NavBar Bitis -->

    <!-- Javascript Alani Alt Baslangic -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/prism.js"></script>
    <script src="../js/script.js"></script>
    <!-- Javascript Alani Alt Bitis -->
</body>
</html>
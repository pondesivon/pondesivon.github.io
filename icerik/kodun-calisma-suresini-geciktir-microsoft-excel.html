<!DOCTYPE html>
<html lang="tr">
<head>
    <!-- Meta Bolumu Baslangic -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Kişisel veri tabanı." />
    <meta name="author" content="pondesivon" />
    <!-- Meta Bolumu Bitis -->
    
    <!-- Title Alani Baslangic -->
	<title>Kodun Çalışma Süresini Geciktir - Microsoft Excel</title>
	<!-- Title Alani Bitis -->

    <!-- Favicon Baslangic -->
    <link rel="icon" type="image/x-icon" href="../doc/favicon.ico" />
    <!-- Favicon Bitis -->

    <!-- CSS Alani Baslangic -->
    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../css/prism.css" rel="stylesheet" />
    <link href="../css/style.css" rel="stylesheet" />
    <!-- CSS Alani Bitis -->
</head>
<body>
    <!-- Responsive NavBar Baslangic -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand btn btn-secondary" href="../index.html">Pondesivon</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" aria-current="page" href="../index.html">Ana Sayfa</a></li>
                    <li class="nav-item"><a class="nav-link" href="../arsiv.html">Arşiv</a></li>
                    <li class="nav-item"><a class="nav-link" href="../notlar.html">Notlar</a></li>
                    <li class="nav-item"><a class="nav-link" href="../sayfalar.html">Sayfalar</a></li>
                    <li class="nav-item">
                        <span class="btn btn-secondary mr-2" onclick="sayfaninBasinaGit();">▲</span>
                        <span class="btn btn-secondary mr-2" onclick="sayfaninSonunaGit();">▼</span>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Responsive NavBar Bitis -->

    <!-- Kapsayici Icerik Alani Baslangic -->
    <div class="container min-vh-100 mb-2">

        <!-- Icerik Ana Satir Baslangic -->
        <div class="row">

            <!-- Icerik Ana Sutun Baslangic -->
            <div class="col">

<!-- ################################################## -->
<!-- Icerik Metin Baslangic -->
<h1 class="mt-3">Kodun Çalışma Süresini Geciktir - Microsoft Excel</h1><hr class="mt-1 mb-1"><p class="lead">API kullanarak bir sub yordam içindeki kodların çalışma süresini (milisaniye cinsinden) istediğimiz kadar geciktirebileceğimiz alternatif bir makro kodudur.</p>
<!-- bol -->
<div class="alert alert-dark"><strong>Bilgi</strong></div>
<p>“Neden kodun çalışma süresini geciktirmek isteyeyim ki?” tarzı bir soru aklınıza gelmiş olabilir. Bir örnekle açıklamaya çalışayım.</p>

<p>Örneğin bir dosyadan veri çekeceğinizi varsayalım ve bunun için de dosyayı açmanız gerekiyor. Gel gelelim dosya da büyük olduğundan açılması uzun sürüyor.</p>

<p>Şimdi eğer sizin kodlarınız dosya daha açılamadan çalışmaya devam ederse olmayan bir şey üzerinde bir şeyler yapmaya çalışır ki, bu istediğimiz bir şey değil. Bunun önüne geçebilmek için bunu kullanabiliriz mesela. İşte bu noktada “Dosya açılması 15 saniyeyi bulur, sen o zamana kadar bekle bakalım.” şeklindeki düşüncemizi hayata geçirmek için <code>SleepEx</code> fonksiyonu bir alternatif olabilir.</p>

<div class="alert alert-dark"><strong>Kod</strong></div>
<p><pre><code class="language-vb">
Option Explicit

#If VBA7 And Win64 Then
    Private Declare PtrSafe Function SleepEx Lib "kernel32" _
    (ByVal dwMilliseconds As Long, ByVal bAlertable As Long) As Long
#Else
    Private Declare Function SleepEx Lib "kernel32" _
    (ByVal dwMilliseconds As Long, ByVal bAlertable As Long) As Long
#End If


Sub KoduCalismaEsnasindaBeklet()
    'Kodlar ___
    
    SleepEx 2000, False
    
    'Kodlar ___
End Sub
</code></pre></p>

<div class="alert alert-dark"><strong>Kod (Açıklamalı)</strong></div>
<p><pre><code class="language-vb">
Option Explicit

'--------------------------------------------------
'VBA sürümüyle ve 32bit 64bit konusunda sıkıntı yaşamamak için
'kontrol yaptırıyoruz. Örneğin ilk şart sağlanmıyorsa kodlar
'VBA panelinde kırmızı renkte görünecek.
'--------------------------------------------------
#If VBA7 And Win64 Then
    Private Declare PtrSafe Function SleepEx Lib "kernel32" _
    (ByVal dwMilliseconds As Long, ByVal bAlertable As Long) As Long
#Else
    Private Declare Function SleepEx Lib "kernel32" _
    (ByVal dwMilliseconds As Long, ByVal bAlertable As Long) As Long
#End If


Sub KoduCalismaEsnasindaBeklet()
    'Kodlar ___
    
    
    
    '--------------------------------------------------
    'Sub yordamda kodların arasına
    '(gerekli gördüğümüz yere)
    'geciktirme fonksiyonunu ekledik.
    '
    'İlk parametre ne kadar geciktireceğimizi
    'milisaniye cinsinden belirlememize yarıyor.
    'İkinci parametrenin ne işe yaradığını
    'anlayamadım maalesef.
    '--------------------------------------------------
    SleepEx 2500, False
    
    
    
    'Kodlar ___
End Sub
</code></pre></p>

<div class="alert alert-dark"><strong>Yararlanılan Kaynaklar</strong></div>
<div class="list-group">
    <a href="https://excelturkey.com/konu/vba-kod-uyutma-sleep-function.581/" rel="nofollow noopener" target="_blank" class="list-group-item bg-light text-secondary">https://excelturkey.com/konu/vba-kod-uyutma-sleep-function.581/</a>
    <a href="http://vbcity.com/forums/t/48234.aspx”]http://vbcity.com/forums/t/48234.aspx" rel="nofollow noopener" target="_blank" class="list-group-item bg-light text-secondary">http://vbcity.com/forums/t/48234.aspx”]http://vbcity.com/forums/t/48234.aspx</a>
    <a href="https://books.google.com.tr/books?id=NHUwYBDK5TYC&lpg=PA479&ots=FASvWSrocm&dq=Private%20Declare%20Function%20SleepEx%20Lib%20%22kernel32%22&hl=tr&pg=PA479#v=onepage&q=Private%20Declare%20Function%20SleepEx%20Lib%20%22kernel32%22&f=false" rel="nofollow noopener" target="_blank" class="list-group-item bg-light text-secondary">https://books.google.com.tr/books?id=NHUwYBDK5TYC&lpg=PA479&ots=FASvWSrocm&dq=Private%20Declare%20Function%20SleepEx%20Lib%20%22kernel32%22&hl=tr&pg=PA479#v=onepage&q=Private%20Declare%20Function%20SleepEx%20Lib%20%22kernel32%22&f=false</a>
</div>

<div class="alert alert-dark"><strong>Etiketler</strong></div><span class='btn btn-light bg-gri'>microsoft excel</span> <span class='btn btn-light bg-gri'>açıklamalı içerik</span> <span class='btn btn-light bg-gri'>microsoft excel vba</span><hr>
<!-- Icerik Metin Bitis -->
<!-- ################################################## -->

            </div>
            <!-- Icerik Ana Sutun Bitis -->

        </div>
        <!-- Icerik Ana Satir Bitis -->

    </div>
    <!-- Kapsayici Icerik Alani Bitis -->

    <!-- Responsive NavBar Baslangic -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand btn btn-secondary" href="../index.html">Pondesivon</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" aria-current="page" href="../index.html">Ana Sayfa</a></li>
                    <li class="nav-item"><a class="nav-link" href="../arsiv.html">Arşiv</a></li>
                    <li class="nav-item"><a class="nav-link" href="../sayfalar.html">Sayfalar</a></li>
                    <li class="nav-item">
                        <span class="btn btn-secondary mr-2" onclick="sayfaninBasinaGit();">▲</span>
                        <span class="btn btn-secondary mr-2" onclick="sayfaninSonunaGit();">▼</span>
                    </li>                
                </ul>
            </div>
        </div>
    </nav>
    <!-- Responsive NavBar Bitis -->

    <!-- Javascript Alani Alt Baslangic -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/prism.js"></script>
    <script src="../js/script.js"></script>
    <!-- Javascript Alani Alt Bitis -->
</body>
</html>